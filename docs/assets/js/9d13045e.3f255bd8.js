"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[8014],{7791:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>t,default:()=>a,frontMatter:()=>c,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"inferflow/v1.0.0/configuration","title":"Configuration Guide","description":"Inferflow is fully config-driven. All model onboarding, feature retrieval logic, DAG topology, and inference behavior are controlled through configuration stored in etcd \u2014 with zero code changes required.","source":"@site/docs/inferflow/v1.0.0/configuration.md","sourceDirName":"inferflow/v1.0.0","slug":"/inferflow/v1.0.0/configuration","permalink":"/BharatMLStack/inferflow/v1.0.0/configuration","draft":false,"unlisted":false,"editUrl":"https://github.com/Meesho/BharatMLStack/tree/main/docs/docs/inferflow/v1.0.0/configuration.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"title":"Configuration Guide","sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"Key Functionalities","permalink":"/BharatMLStack/inferflow/v1.0.0/functionalities"},"next":{"title":"Release Notes","permalink":"/BharatMLStack/inferflow/v1.0.0/release-notes"}}');var s=r(4848),d=r(8453);const c={title:"Configuration Guide",sidebar_position:3},t="Inferflow - Configuration Guide",l={},o=[{value:"Configuration Overview",id:"configuration-overview",level:2},{value:"Static Configuration (Environment Variables)",id:"static-configuration-environment-variables",level:2},{value:"Server",id:"server",level:3},{value:"etcd",id:"etcd",level:3},{value:"Online Feature Store (OnFS)",id:"online-feature-store-onfs",level:3},{value:"Predator (Model Serving)",id:"predator-model-serving",level:3},{value:"Numerix (Compute Engine)",id:"numerix-compute-engine",level:3},{value:"Kafka (Inference Logging)",id:"kafka-inference-logging",level:3},{value:"Metrics (StatsD / Telegraf)",id:"metrics-statsd--telegraf",level:3},{value:"In-Memory Cache",id:"in-memory-cache",level:3},{value:"Dynamic Configuration (etcd Model Config)",id:"dynamic-configuration-etcd-model-config",level:2},{value:"Config Structure",id:"config-structure",level:3},{value:"DAG Execution Config",id:"dag-execution-config",level:3},{value:"Feature Component Config",id:"feature-component-config",level:3},{value:"Predator Component Config",id:"predator-component-config",level:3},{value:"Numerix Component Config",id:"numerix-component-config",level:3},{value:"Response Config",id:"response-config",level:3},{value:"Service-Level Config",id:"service-level-config",level:3},{value:"Example: Onboarding a New Model",id:"example-onboarding-a-new-model",level:2},{value:"Contributing",id:"contributing",level:2},{value:"Community &amp; Support",id:"community--support",level:2},{value:"License",id:"license",level:2}];function h(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"inferflow---configuration-guide",children:"Inferflow - Configuration Guide"})}),"\n",(0,s.jsxs)(n.p,{children:["Inferflow is fully config-driven. All model onboarding, feature retrieval logic, DAG topology, and inference behavior are controlled through configuration stored in ",(0,s.jsx)(n.strong,{children:"etcd"})," \u2014 with zero code changes required."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"configuration-overview",children:"Configuration Overview"}),"\n",(0,s.jsx)(n.p,{children:"Inferflow configuration is organized into two layers:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Static config"})," \u2014 Environment variables loaded at startup (via Viper)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Dynamic config"})," \u2014 Model configurations stored in etcd, hot-reloaded on change"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"static-configuration-environment-variables",children:"Static Configuration (Environment Variables)"}),"\n",(0,s.jsx)(n.p,{children:"These are set at deployment time and require a restart to change."}),"\n",(0,s.jsx)(n.h3,{id:"server",children:"Server"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Variable"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Example"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"APP_PORT"})}),(0,s.jsx)(n.td,{children:"gRPC/HTTP server port"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"50051"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"APP_ENV"})}),(0,s.jsx)(n.td,{children:"Environment name"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"production"})})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"etcd",children:"etcd"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Variable"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Example"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"ETCD_ENDPOINTS"})}),(0,s.jsx)(n.td,{children:"Comma-separated etcd endpoints"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"etcd-0:2379,etcd-1:2379"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"ETCD_DIAL_TIMEOUT"})}),(0,s.jsx)(n.td,{children:"Connection timeout"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"5s"})})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"online-feature-store-onfs",children:"Online Feature Store (OnFS)"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Variable"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Example"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"externalServiceOnFs_host"})}),(0,s.jsx)(n.td,{children:"OnFS gRPC host"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"onfs-api:50051"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"externalServiceOnFs_callerId"})}),(0,s.jsx)(n.td,{children:"Caller ID for auth"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"inferflow"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"externalServiceOnFs_callerToken"})}),(0,s.jsx)(n.td,{children:"Caller token for auth"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"<token>"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"externalServiceOnFs_batchSize"})}),(0,s.jsx)(n.td,{children:"Batch size for feature retrieval"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"100"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"externalServiceOnFs_deadline"})}),(0,s.jsx)(n.td,{children:"Request deadline"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"200ms"})})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"predator-model-serving",children:"Predator (Model Serving)"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Variable"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Example"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"externalServicePredator_defaultDeadline"})}),(0,s.jsx)(n.td,{children:"Default inference deadline"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"100ms"})})]})})]}),"\n",(0,s.jsx)(n.h3,{id:"numerix-compute-engine",children:"Numerix (Compute Engine)"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Variable"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Example"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"numerixClientV1_host"})}),(0,s.jsx)(n.td,{children:"Numerix gRPC host"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"numerix:50052"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"numerixClientV1_deadline"})}),(0,s.jsx)(n.td,{children:"Request deadline"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"100ms"})})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"kafka-inference-logging",children:"Kafka (Inference Logging)"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Variable"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Example"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"KafkaBootstrapServers"})}),(0,s.jsx)(n.td,{children:"Kafka broker addresses"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"kafka-0:9092,kafka-1:9092"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"KafkaLoggingTopic"})}),(0,s.jsx)(n.td,{children:"Topic for inference logs"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"inferflow-logs"})})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"metrics-statsd--telegraf",children:"Metrics (StatsD / Telegraf)"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Variable"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Example"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"TELEGRAF_HOST"})}),(0,s.jsx)(n.td,{children:"StatsD host"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"telegraf"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"TELEGRAF_PORT"})}),(0,s.jsx)(n.td,{children:"StatsD port"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"8125"})})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"in-memory-cache",children:"In-Memory Cache"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Variable"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Example"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"CACHE_SIZE_MB"})}),(0,s.jsx)(n.td,{children:"Cache size in MB"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"512"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"CACHE_TYPE"})}),(0,s.jsx)(n.td,{children:"Cache implementation"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"freecache"})})]})]})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"dynamic-configuration-etcd-model-config",children:"Dynamic Configuration (etcd Model Config)"}),"\n",(0,s.jsxs)(n.p,{children:["Model configurations are stored in etcd and hot-reloaded. Each model is identified by a ",(0,s.jsx)(n.code,{children:"model_config_id"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"config-structure",children:"Config Structure"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n    "model_config_id_example": {\n        "dag_execution_config": {\n            "component_dependency": {\n                "feature_initializer": ["fs_user", "fs_product"],\n                "fs_user": ["ranker_model"],\n                "fs_product": ["ranker_model"],\n                "ranker_model": []\n            }\n        },\n        "component_config": {\n            "feature_component_config": {\n                "fs_user": { ... },\n                "fs_product": { ... }\n            },\n            "predator_component_config": {\n                "ranker_model": { ... }\n            },\n            "numerix_component_config": {},\n            "cache_enabled": true,\n            "cache_version": "v1",\n            "cache_ttl": 300,\n            "error_logging_percent": 10\n        },\n        "response_config": {\n            "features": ["ranker_model:score"],\n            "model_schema_perc": 100,\n            "logging_perc": 5,\n            "log_features": ["fs_user:profile:age", "ranker_model:score"],\n            "log_batch_size": 100\n        }\n    }\n}\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"dag-execution-config",children:"DAG Execution Config"}),"\n",(0,s.jsx)(n.p,{children:"Defines the component dependency graph."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n    "component_dependency": {\n        "<parent_component>": ["<child_1>", "<child_2>"],\n        "<child_1>": ["<grandchild>"],\n        "<child_2>": ["<grandchild>"],\n        "<grandchild>": []\n    }\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Rules:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"The graph must be a valid DAG (no cycles)"}),"\n",(0,s.jsx)(n.li,{children:"Components with no parents (zero in-degree) execute first"}),"\n",(0,s.jsxs)(n.li,{children:["Components with empty dependency arrays ",(0,s.jsx)(n.code,{children:"[]"})," are leaf nodes"]}),"\n",(0,s.jsxs)(n.li,{children:["All component names must match registered components in the ",(0,s.jsx)(n.code,{children:"ComponentConfig"})]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"feature-component-config",children:"Feature Component Config"}),"\n",(0,s.jsx)(n.p,{children:"Configures how features are fetched from the Online Feature Store."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n    "fs_user": {\n        "fs_keys": {\n            "schema": ["user_id"],\n            "col": "context:user:user_id"\n        },\n        "fs_request": {\n            "entity_label": "user",\n            "feature_groups": [\n                {\n                    "label": "demographics",\n                    "feature_labels": ["age", "location", "income_bracket"]\n                },\n                {\n                    "label": "behavior",\n                    "feature_labels": ["click_rate", "purchase_freq"]\n                }\n            ]\n        },\n        "fs_flatten_resp_keys": ["user_id"],\n        "col_name_prefix": "user",\n        "comp_cache_enabled": true,\n        "comp_cache_ttl": 600,\n        "composite_id": false\n    }\n}\n'})}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Field"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"fs_keys"})}),(0,s.jsxs)(n.td,{children:["How to extract lookup keys from the matrix. ",(0,s.jsx)(n.code,{children:"schema"})," defines key column names; ",(0,s.jsx)(n.code,{children:"col"})," references a matrix column"]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"fs_request"})}),(0,s.jsx)(n.td,{children:"OnFS query: entity label + feature groups with specific features"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"fs_flatten_resp_keys"})}),(0,s.jsx)(n.td,{children:"Keys to flatten in response mapping"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"col_name_prefix"})}),(0,s.jsxs)(n.td,{children:["Prefix for matrix column names (e.g., ",(0,s.jsx)(n.code,{children:"user:demographics:age"}),")"]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"comp_cache_enabled"})}),(0,s.jsx)(n.td,{children:"Enable in-memory caching for this component"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"comp_cache_ttl"})}),(0,s.jsx)(n.td,{children:"Cache TTL in seconds"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"composite_id"})}),(0,s.jsx)(n.td,{children:"Whether entity keys are composite"})]})]})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"predator-component-config",children:"Predator Component Config"}),"\n",(0,s.jsx)(n.p,{children:"Configures model inference endpoints."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n    "ranker_model": {\n        "model_name": "product_ranker_v3",\n        "model_endpoint": "predator-ranker:8080",\n        "model_end_points": {\n            "predator-ranker-v3:8080": 80,\n            "predator-ranker-v4:8080": 20\n        },\n        "deadline": 100,\n        "batch_size": 50,\n        "calibration": {\n            "enabled": false\n        },\n        "inputs": {\n            "feature_map": {\n                "user:demographics:age": "INT32",\n                "user:behavior:click_rate": "FP32",\n                "product:attributes:category_id": "INT32"\n            }\n        },\n        "outputs": {\n            "score_columns": ["score", "confidence"]\n        },\n        "slate_component": false\n    }\n}\n'})}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Field"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"model_name"})}),(0,s.jsx)(n.td,{children:"Model identifier on the serving platform"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"model_endpoint"})}),(0,s.jsx)(n.td,{children:"Primary model serving endpoint"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"model_end_points"})}),(0,s.jsx)(n.td,{children:"Multiple endpoints with percentage-based traffic routing"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"deadline"})}),(0,s.jsx)(n.td,{children:"Inference timeout in milliseconds"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"batch_size"})}),(0,s.jsx)(n.td,{children:"Max items per inference batch"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"calibration"})}),(0,s.jsx)(n.td,{children:"Score calibration settings"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"inputs.feature_map"})}),(0,s.jsx)(n.td,{children:"Map of matrix column \u2192 data type for model input"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"outputs.score_columns"})}),(0,s.jsx)(n.td,{children:"Column names for model output scores"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"slate_component"})}),(0,s.jsx)(n.td,{children:"If true, runs per-slate inference"})]})]})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"numerix-component-config",children:"Numerix Component Config"}),"\n",(0,s.jsx)(n.p,{children:"Configures compute operations (e.g., reranking)."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n    "reranker": {\n        "score_column": "final_score",\n        "data_type": "FP32",\n        "score_mapping": {\n            "ranker_model:score": "FP32",\n            "user:behavior:click_rate": "FP32"\n        },\n        "compute_id": "diversity_rerank_v1",\n        "slate_component": false\n    }\n}\n'})}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Field"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"score_column"})}),(0,s.jsx)(n.td,{children:"Output column name for the computed score"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"data_type"})}),(0,s.jsx)(n.td,{children:"Output data type"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"score_mapping"})}),(0,s.jsx)(n.td,{children:"Map of matrix columns to include as compute inputs"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"compute_id"})}),(0,s.jsx)(n.td,{children:"Identifies the compute operation on Numerix"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"slate_component"})}),(0,s.jsx)(n.td,{children:"If true, runs per-slate compute"})]})]})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"response-config",children:"Response Config"}),"\n",(0,s.jsx)(n.p,{children:"Controls what data is returned to the client and what is logged."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n    "features": ["ranker_model:score", "reranker:final_score"],\n    "model_schema_perc": 100,\n    "logging_perc": 5,\n    "log_features": [\n        "user:demographics:age",\n        "ranker_model:score",\n        "reranker:final_score"\n    ],\n    "log_batch_size": 100\n}\n'})}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Field"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"features"})}),(0,s.jsx)(n.td,{children:"Matrix columns to include in the gRPC response"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"model_schema_perc"})}),(0,s.jsx)(n.td,{children:"Percentage of requests that include full schema in response"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"logging_perc"})}),(0,s.jsx)(n.td,{children:"Percentage of requests to send to Kafka for logging"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"log_features"})}),(0,s.jsx)(n.td,{children:"Specific features to include in log messages"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"log_batch_size"})}),(0,s.jsx)(n.td,{children:"Batch size for grouped log messages"})]})]})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"service-level-config",children:"Service-Level Config"}),"\n",(0,s.jsx)(n.p,{children:"Global settings that apply across all models."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n    "v2_logging_type": "proto",\n    "compression_enabled": false\n}\n'})}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Field"}),(0,s.jsx)(n.th,{children:"Values"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"v2_logging_type"})}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:"proto"}),", ",(0,s.jsx)(n.code,{children:"arrow"}),", ",(0,s.jsx)(n.code,{children:"parquet"})]}),(0,s.jsx)(n.td,{children:"Serialization format for Kafka inference logs"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"compression_enabled"})}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:"true"}),", ",(0,s.jsx)(n.code,{children:"false"})]}),(0,s.jsx)(n.td,{children:"Enable compression for log messages"})]})]})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"example-onboarding-a-new-model",children:"Example: Onboarding a New Model"}),"\n",(0,s.jsx)(n.p,{children:"To onboard a new ranking model, update the etcd config:"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Step 1:"})," Define the feature retrieval graph"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'"component_dependency": {\n    "feature_initializer": ["fs_user", "fs_product", "fs_user_x_category"],\n    "fs_product": ["fs_user_x_category"],\n    "fs_user": ["new_ranker"],\n    "fs_user_x_category": ["new_ranker"],\n    "new_ranker": []\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["Here ",(0,s.jsx)(n.code,{children:"fs_user_x_category"})," depends on ",(0,s.jsx)(n.code,{children:"fs_product"})," because it needs the category ID extracted from the product entity to resolve the user x category key."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Step 2:"})," Configure each component (feature groups, model endpoints, etc.)"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Step 3:"})," Push the config to etcd \u2014 Inferflow picks it up automatically via watchers."]}),"\n",(0,s.jsx)(n.p,{children:"No code changes. No redeployment. The new model is live."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"contributing",children:"Contributing"}),"\n",(0,s.jsxs)(n.p,{children:["We welcome contributions from the community! Please see our ",(0,s.jsx)(n.a,{href:"https://github.com/Meesho/BharatMLStack/blob/main/CONTRIBUTING.md",children:"Contributing Guide"})," for details on how to get started."]}),"\n",(0,s.jsx)(n.h2,{id:"community--support",children:"Community & Support"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Discord"}),": Join our ",(0,s.jsx)(n.a,{href:"https://discord.gg/XkT7XsV2AU",children:"community chat"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Issues"}),": Report bugs and request features on ",(0,s.jsx)(n.a,{href:"https://github.com/Meesho/BharatMLStack/issues",children:"GitHub Issues"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Email"}),": Contact us at ",(0,s.jsx)(n.a,{href:"mailto:ml-oss@meesho.com",children:"ml-oss@meesho.com"})]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"license",children:"License"}),"\n",(0,s.jsxs)(n.p,{children:["BharatMLStack is open-source software licensed under the ",(0,s.jsx)(n.a,{href:"https://github.com/Meesho/BharatMLStack/blob/main/LICENSE.md",children:"BharatMLStack Business Source License 1.1"}),"."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)("div",{align:"center",children:(0,s.jsx)("strong",{children:"Built with \u2764\ufe0f for the ML community from Meesho"})}),"\n",(0,s.jsx)("div",{align:"center",children:(0,s.jsx)("strong",{children:"If you find this useful, \u2b50\ufe0f the repo \u2014 your support means the world to us!"})})]})}function a(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>c,x:()=>t});var i=r(6540);const s={},d=i.createContext(s);function c(e){const n=i.useContext(d);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),i.createElement(d.Provider,{value:n},e.children)}}}]);